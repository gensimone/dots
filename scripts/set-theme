#!/usr/bin/env bash

wal -i $1

if [[ $? -ne 0 ]]; then
  exit 1
fi

# -- telegram-desktop
walogram -s

# -- chromium
chromium-wal
pidof chromium && killall chromium && chromium --restore-last-session &

# -- dunst
[ -f "$HOME/.cache/wal/colors.sh" ] && . "$HOME/.cache/wal/colors.sh"
cat ~/.config/dunst/dunstrc | head -n 460 >~/.config/dunst/tmp
echo "[urgency_low]
    # IMPORTANT: colors have to be defined in quotation marks.
    # Otherwise the "#" and following would be interpreted as a comment.
    background = \"$color0\"
    foreground = \"$color1\"
    frame_color = \"$color2\"
    timeout = 10
    # Icon for notifications with low urgency, uncomment to enable
    #default_icon = /path/to/icon
[urgency_normal]
    background = \"$color0\"
    foreground = \"$color1\"
    frame_color = \"$color2\"
    timeout = 10
    override_pause_level = 30
    # Icon for notifications with normal urgency, uncomment to enable
    #default_icon = /path/to/icon
[urgency_critical]
    background = \"$color0\"
    foreground = \"$color1\"
    frame_color = \"$color2\"
    timeout = 0
    override_pause_level = 60
    # Icon for notifications with critical urgency, uncomment to enable
    #default_icon = /path/to/Icon
" >>~/.config/dunst/tmp
mv ~/.config/dunst/tmp ~/Codes/dots/configs/dunst

pidof dunst && killall dunst && dunst &
sleep 2
notify-send "Theme changed"

# --discord
pywal-discord -t default
